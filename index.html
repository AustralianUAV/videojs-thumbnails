<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>videojs-thumbnails Demo</title>
  <link href="node_modules/video.js/dist/video-js.css" rel="stylesheet">
  <link href="dist/browser/videojs-thumbnails.css" rel="stylesheet">
</head>
<body>
  <video id="videojs-thumbnails-player" class="video-js vjs-default-skin" controls>
    <source src="//vjs.zencdn.net/v/oceans.mp4" type="video/mp4">
    <source src="//vjs.zencdn.net/v/oceans.webm" type="video/webm">
  </video>
  <ul>
    <li><a href="test/">Run unit tests in browser.</a></li>
    
    
  </ul>
  <script src="node_modules/video.js/dist/video.js"></script>
  <script src="dist/browser/videojs-thumbnails.js"></script>
  <script>
    (function(window, videojs) {
      var player = window.player = videojs('videojs-thumbnails-player');

      let prepareTresholds = (videoTime) => {
          let currentTime = 0;
          const stepTime = 2;
          let currentIteration = 0;
          const thumbnailWidth = 100;
          let thumbnailOffset = 0;
          const spriteURL = "http://twig-video-europe.s3.amazonaws.com/TWG00024/2012-11-30/thumbnail/sprite.jpg";
          const tresholds = {
            0: {
              src: spriteURL,
              style: {
                left: (thumbnailWidth / 2 * -1) + 'px',
                width: ((Math.floor(videoTime / stepTime) + 1) * thumbnailWidth) + 'px',
                height: '86px',
                padding: '5px 0 23px 0',
                background: 'rgba(255,255,255,0.7)',
                clip: 'rect(0, 100px, 100px, 0)'
              }
            }
          };

          while (currentTime <= videoTime) {
            currentTime += stepTime;
            thumbnailOffset = ++currentIteration * thumbnailWidth;
            tresholds[currentTime] = {
              style: {
                left: ((thumbnailWidth / 2 + thumbnailOffset) * -1) + "px",
                clip: "rect(0, " + (thumbnailWidth + thumbnailOffset) + "px, 100px, " + thumbnailOffset + "px)"
              }
            };
          }
          return tresholds;
        };


        if (player.readyState() < 1) {
          player.on('loadedmetadata', (() => {
            player.thumbnails(prepareTresholds(player.duration()));
          }));
        } else {
          player.thumbnails(prepareTresholds(player.duration()));
        }

    }(window, window.videojs));
  </script>
</body>
</html>
